<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>通过Map处理数据更新</title>
      <link href="/2025/09/18/20250918%E5%B7%A5%E4%BD%9C/"/>
      <url>/2025/09/18/20250918%E5%B7%A5%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<p>在处理列表新增时遇到一个这个问题，通过组件选中的数据来新增，已经勾选过的组件还是勾上的，带出的数据是选中的数据，这时就有问题你不能简单的通过将选中的数据push到一个数组里面就可以，当用户选了一个数据又再次勾选时，你会有重复数据，当用户取消勾选时你获取到的是空数组，也不能使用直接将选择出来的数组直接替代，如果用户有编辑数据会导致数据丢失影响体验，这个时候就需要使用Map数据结构来进行处理了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">checkInspection</span>(<span class="params">checkNames, checkData</span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 首先 创建一个Map</span></span><br><span class="line">      <span class="keyword">const</span> existingMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">checkInspectionList</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (item.<span class="property">keypointItemId</span>) &#123;</span><br><span class="line">          <span class="comment">// 将列表里面的id为键 将数组进行保存</span></span><br><span class="line">          existingMap.<span class="title function_">set</span>(item.<span class="property">keypointItemId</span>, item);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 处理逻辑：</span></span><br><span class="line">      <span class="comment">// 1. 仅保留checkData中存在的项（自动删除缺失项）</span></span><br><span class="line">      <span class="comment">// 2. 对存在的项进行属性更新</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">checkInspectionList</span> = checkData.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; keypointItemId &#125; = item;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"><span class="comment">// 这块判断勾选的数据之前已经存在就将数据return出去</span></span><br><span class="line">        <span class="comment">// 复用并更新已有项（保持引用一致性）</span></span><br><span class="line">        <span class="keyword">if</span> (existingMap.<span class="title function_">has</span>(keypointItemId)) &#123;</span><br><span class="line">          <span class="keyword">const</span> existingItem = existingMap.<span class="title function_">get</span>(keypointItemId);</span><br><span class="line">          <span class="keyword">return</span> &#123; ...existingItem, ...item &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 新增项初始化 </span></span><br><span class="line">        <span class="keyword">return</span> &#123; ...item, <span class="attr">isProblem</span>: <span class="number">0</span>, <span class="attr">isDelete</span>: <span class="number">1</span>, <span class="attr">delFlag</span>: <span class="number">0</span>, <span class="attr">problemType</span>: <span class="number">1</span>, &#125;;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p>这块是直接对组件的数据进行map遍历，这样就做到了删除，更新的操作，<code>existingMap.has</code>存在则复用数据</p>]]></content>
      
      
      <categories>
          
          <category> 工作 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>daily</title>
      <link href="/daily/index.html"/>
      <url>/daily/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>link</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>music</title>
      <link href="/music/index-1.html"/>
      <url>/music/index-1.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>about</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>music</title>
      <link href="/music/index.html"/>
      <url>/music/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>tags</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[<p>111</p>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>work</title>
      <link href="/work/index.html"/>
      <url>/work/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
